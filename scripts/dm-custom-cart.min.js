function syncFoxyCart(){const e=Alpine.store("cart");FC.client.request("https://"+FC.settings.storedomain+"/cart?cart=view&output=json").done(function(t){if(0===t.items.length)return void e.clearItems();const n=t.items[0].options.filter(e=>"item_codes"===e.class)[0].value.split(",");e.addItems(n)})}var FC=FC||{};FC.onLoad=function(){const e=Alpine.store("cart");FC.client.on("ready.done",function(){syncFoxyCart()}),FC.client.on("cart-item-remove",function(){e.clearItems()})};const PLAN_TYPES={PHOTO:"Photo",VIDEO:"Video"},PLAN_TERMS={MONTHLY:{id:"MONTHLY",termsText:"month",subFrequency:"1m"},ANNUAL:{id:"ANNUAL",termsText:"year",subFrequency:"1y"}},PLAN_COMMITMENT={MONTHLY:"MONTHLY",ANNUAL:"ANNUAL"},DM_PLANS={PHOTO_ONLY:{displayName:"Photo",code:"PHOTO_ONLY"},VIDEO_ONLY:{displayName:"Video",code:"VIDEO_ONLY"},PHOTO_AND_VIDEO:{displayName:"Photo and Video",code:"PHOTO_AND_VIDEO"}};let roundOff=(e,t)=>{const n=Math.pow(10,t);return Math.round(e*n)/n};document.addEventListener("alpine:init",()=>{Alpine.store("cart",{items:[],total:0,baseTotal:0,annualTotal:0,terms:PLAN_TERMS.MONTHLY,monthlyURL:"",annualURL:"",toggleAddOns(e){let t=this.items.some(t=>t.code===e),n=Array.from(document.querySelectorAll(`.add-on-for-${e}`)),s=Array.from(document.querySelectorAll(`.add-on_heading-for-${e}`));n.map(e=>{e.style.display=t?"flex":"none"}),s.map(e=>{e.style.opacity=t?"1":"0"})},toggleOtherAddOns(){let e=this.items.length>0,t=this.items.filter(e=>"dm-general"===e.parentCode).length,n=Array.from(document.querySelectorAll(".other-add-on_option")),s=Array.from(document.querySelectorAll(".other-add-on_heading"));if(n.map(t=>{t.style.display=e?"flex":"none"}),s.map(t=>{e?(t.style.opacity="1",t.style.display="block"):(t.style.opacity="0",t.style.display="none")}),this.items.length===t){this.items=[],this.total=0,document.querySelectorAll(".option-selected").forEach(e=>e.classList.remove("option-selected")),n.map(e=>{e.style.display="none"}),s.map(e=>{e.style.opacity="0",e.style.display="none"})}},setTotal(){this.setBaseTotal(),this.setMonthlyTotal(),this.setAnnualTotal()},setBaseTotal(){let e=0;this.items.map(t=>e+=parseInt(t.price)),this.getMonthlyPlan()==DM_PLANS.PHOTO_AND_VIDEO&&(e*=.9),this.baseTotal=roundOff(e,0)},setMonthlyTotal(){document.getElementById("PlanTotal-Monthly").innerText=this.baseTotal.toLocaleString("en-US"),this.setMonthlyURL()},setAnnualTotal(){this.annualTotal=roundOff(.8*this.baseTotal,0),document.getElementById("PlanTotal-Annual").innerText=this.annualTotal.toLocaleString("en-US"),this.setAnnualURL()},toggleItem(e){let t=e.target.dataset,n=""===t.parentCode;this.items.filter(e=>e.code===t.code);const s=this.items.some(e=>e.code===t.code);if(document.querySelector(`[data-option='${t.code}']`).setAttribute("data-selected","true"===t.selected?"false":"true"),s){let s=this.items.findIndex(e=>e.code===t.code);if(this.items.splice(s,1),n){e.target.classList.remove("plan-add-btn_selected"),e.target.innerText="ADD";let n=this.items.filter(e=>e.parentCode!=t.code);this.items=n,document.querySelectorAll(`[data-parent-code='${t.code}'`).forEach(e=>e.classList.remove("option-selected"))}else{document.getElementById(`option-${t.code}`).classList.remove("option-selected")}}else if(this.items.push(t),n)e.target.classList.add("plan-add-btn_selected"),e.target.innerText="ADDED!";else{document.getElementById("option-"+t.code).classList.add("option-selected")}this.toggleAddOns(t.code),this.toggleOtherAddOns(),this.setTotal()},getMonthlyPlan(){return this.items.filter(e=>e.name===PLAN_TYPES.PHOTO).length>0&&this.items.filter(e=>e.name===PLAN_TYPES.VIDEO).length>0?DM_PLANS.PHOTO_AND_VIDEO:this.items.filter(e=>e.name===PLAN_TYPES.PHOTO).length>0&&0===this.items.filter(e=>e.name===PLAN_TYPES.VIDEO).length?DM_PLANS.PHOTO_ONLY:0===this.items.filter(e=>e.name===PLAN_TYPES.PHOTO).length&&this.items.filter(e=>e.name===PLAN_TYPES.VIDEO).length>0?DM_PLANS.VIDEO_ONLY:null},addItems(e){e.forEach(e=>{document.querySelector(`[data-code='${e}`).click()})},clearItems(){this.items=[],this.total=0,document.querySelectorAll("[data-selected='true']").forEach(e=>{document.querySelectorAll("[id^='Plan-'").forEach(e=>{e.classList.remove("plan-add-btn_selected"),e.innerText="ADD"})}),document.querySelectorAll(".option-selected").forEach(e=>e.classList.remove("option-selected")),this.setTotal()},buildURL(e){if(e!==PLAN_COMMITMENT.ANNUAL&&e!==PLAN_COMMITMENT.MONTHLY)return console.error("Invalid plan commitment."),"";const t=new URL("https://orders.fifthandbroad.com/cart?empty=true");let n=this.getMonthlyPlan();if(null===n)return t;let s=e===PLAN_COMMITMENT.ANNUAL?`${n.displayName} - Annual Commitment`:`${n.displayName} - Month to Month`;t.searchParams.append("name",s),t.searchParams.append("code",n.code),t.searchParams.append("sub_frequency","1m"),t.searchParams.append("price",e===PLAN_COMMITMENT.ANNUAL?this.annualTotal:this.baseTotal),t.searchParams.append("quantity_max",1);let a="",o="",l=[];return this.items.map(e=>{l.push(e.code),"dm-photo"===e.parentCode&&(a+=""===a?e.name:`, ${e.name}`),"dm-video"===e.parentCode&&(o+=""===o?e.name:`, ${e.name}`)}),n!==DM_PLANS.PHOTO_ONLY&&n!==DM_PLANS.PHOTO_AND_VIDEO||t.searchParams.append("Photo_Add_Ons",a),n!==DM_PLANS.VIDEO_ONLY&&n!==DM_PLANS.PHOTO_AND_VIDEO||t.searchParams.append("Video_Add_Ons",o),t.searchParams.append("Item_Codes",l.join(",")),t.searchParams.append("Plan_Terms",e),t},setMonthlyURL(){const e=document.getElementById("PurchaseBtn-Monthly"),t=this.buildURL(PLAN_COMMITMENT.MONTHLY);e.href=t},setAnnualURL(){const e=document.getElementById("PurchaseBtn-Annual"),t=this.buildURL(PLAN_COMMITMENT.ANNUAL);e.href=t}})});